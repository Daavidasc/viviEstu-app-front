<div class="app-container">
  <app-landlord-navbar />

  <!-- Notification Popup -->
  @if (notification.show) {
  <div class="notification-toast" [class]="'notification-' + notification.type">
    <div class="notification-content">
      <div class="notification-message">{{ notification.message }}</div>
      <button class="notification-close" (click)="closeNotification()">
        Entendido
      </button>
    </div>
  </div>
  }

  <main class="main-content">
    <div class="container">
      <!-- Header -->
      <div class="page-header">
        <h1 class="page-title">Solicitudes de Alojamientos</h1>
        <div class="header-stats">
          <span class="total-requests">{{ getTotalRequests() }} solicitudes totales</span>
        </div>
      </div>

      <!-- Loading state -->
      @if (isLoading) {
      <div class="loading-container">
        <p>Cargando solicitudes...</p>
      </div>
      }

      <!-- Accommodations with requests -->
      @if (!isLoading) {
      <div class="accommodations-list">
        @for (accommodation of accommodationsWithRequests; track accommodation.id) {
        <div class="accommodation-card">
          <!-- Accommodation header -->
          <div class="accommodation-header" (click)="toggleAccommodation(accommodation)">
            <div class="accommodation-info">
              <img [src]="accommodation.imageUrl" [alt]="accommodation.title" class="accommodation-image">
              <div class="accommodation-details">
                <h2 class="accommodation-title">
                  <span class="title-text">{{ accommodation.title }}</span>
                </h2>
                <p class="accommodation-address">{{ accommodation.address }}</p>
                <div class="accommodation-meta">
                  <span class="district">{{ accommodation.district }}</span>
                  <span class="price">S/.{{ accommodation.price }}/mes</span>
                </div>
              </div>
            </div>
            <div class="header-actions">
              <div class="requests-count">
                <span class="count-badge">{{ accommodation.requests.length }}</span>
                <span class="count-label">solicitud{{ accommodation.requests.length !== 1 ? 'es' : '' }}</span>
              </div>
              <i class="fas fa-chevron-down chevron" [class.rotated]="accommodation.isExpanded"></i>
            </div>
          </div>

          <!-- Requests list -->
          <div class="requests-section" [class.expanded]="accommodation.isExpanded">
            @if (accommodation.requests.length === 0) {
            <div class="no-requests">
              <p>No hay solicitudes para este alojamiento</p>
            </div>
            } @else {
            <div class="requests-list">
              @for (request of accommodation.requests; track request.requestId) {
              <app-detailed-request [request]="request" (accept)="acceptRequest($event)"
                (reject)="rejectRequest($event)">
              </app-detailed-request>
              }
            </div>
            }
          </div>
        </div>
        }

        @if (accommodationsWithRequests.length === 0) {
        <div class="empty-state">
          <h3>No hay solicitudes</h3>
          <p>Cuando recibas solicitudes para tus alojamientos, aparecerán aquí.</p>
        </div>
        }
      </div>
      }
    </div>
  </main>

  <app-footer />
</div>