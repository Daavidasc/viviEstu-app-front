<div class="app-container">
  <app-student-navbar />

  @if (isLoading) {
  <main class="main-content">
    <div class="container">
      <app-loading-spinner message="Cargando detalles del alojamiento..."></app-loading-spinner>
    </div>
  </main>
  } @else if (errorMessage) {
  <main class="main-content">
    <div class="container">
      <div class="error-message">
        <p>{{ errorMessage }}</p>
      </div>
    </div>
  </main>
  } @else if (accommodation) {
  <main class="main-content">
    <div class="container content-grid">

      <!-- COLUMNA IZQUIERDA: Detalles del Alojamiento -->
      <div class="details-column">
        <div class="card main-card">
          <app-gallery [images]="getImageUrls()" />

          <div class="info-content">
            <!-- Cabecera: Precio y Favorito -->
            <div class="header-row">
              <h1 class="price-tag">S/.{{ accommodation.precioMensual }} <span class="period">/mes</span></h1>
              <button class="btn-favorite" (click)="toggleFavorite()">
                <i class="fa-heart" [class.fas]="accommodation.isFavorite" [class.far]="!accommodation.isFavorite"></i>
              </button>
            </div>

            <p class="description-text">{{ accommodation.descripcion }}</p>

            <!-- Características -->
            <div class="section-block">
              <h3 class="section-label">Incluye:</h3>
              <div class="features-list">
                <span class="feature-tag">{{ accommodation.area }}m²</span>
                <span class="feature-tag">{{ accommodation.banios }} baño{{ accommodation.banios !== 1 ? 's' : ''
                  }}</span>
                <span class="feature-tag">{{ accommodation.habitaciones }} dorm.</span>
              </div>
            </div>

            <!-- Ubicación -->
            <div class="section-block">
              <h3 class="section-label">Ubicación:</h3>
              <p class="info-text">{{ accommodation.direccion }}</p>
              <p class="info-text highlight">{{ accommodation.distrito }}</p>
            </div>

            <!-- Universidades Cercanas -->
            <div class="section-block">
              <h3 class="section-label">Universidades Cercanas:</h3>
              <div class="tags-row">
                @for (uni of accommodation.universidades; track uni) {
                <span class="uni-tag">{{ uni }}</span>
                }
              </div>
            </div>

            <!-- Opciones de Movilidad -->
            <div class="section-block">
              <h3 class="section-label">Opciones de movilidad</h3>
              <div class="tags-row">
                @for (mob of accommodation.transportes; track mob) {
                <span class="mobility-tag">{{ mob }}</span>
                }
              </div>
            </div>

            <!-- Sección de Comentarios -->
            <div class="comments-section">
              <h3 class="section-label">Comentarios:</h3>
              <textarea class="comment-input" rows="4" placeholder="Escribe tu duda o comentario aquí..."
                [(ngModel)]="newComment"></textarea>
              <div class="comment-actions">
                <button class="btn btn-primary btn-comment" (click)="postComment()">Comentar</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- COLUMNA DERECHA: Formulario de Contacto (Sticky) -->
      <div class="sidebar-column">
        <app-contact-form [accommodationId]="accommodation.id" />
      </div>

    </div>
  </main>
  }

  <app-footer />
</div>